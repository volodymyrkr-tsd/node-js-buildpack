#!/usr/bin/env bash
set -e

echo "ðŸ—ï¸ [TSD CNB] Build phase started"
echo "ðŸ“¦ Installing dependencies and configuring Node.js manually (placeholder)"

# ÐŸÑ€Ð¾ÑÑ‚Ð¾ ÐºÐ¾Ð¿Ñ–ÑŽÑ” Ð²ÑÐµ Ð² /layers/tsd-layer Ñ– Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÑŽÑ” Ð·Ð°Ð¿ÑƒÑÐº
APP_DIR=${1}
LAYERS_DIR=${2}
ENV_DIR=${3}

mkdir -p "${LAYERS_DIR}/tsd-layer"
cp -r "${APP_DIR}"/* "${LAYERS_DIR}/tsd-layer/"

cat > "${LAYERS_DIR}/tsd-layer/launch.toml" <<EOF
[[processes]]
type = "web"
command = "node"
args = ["app.js"]
default = true
EOF

echo "âœ… [TSD CNB] Build phase finished"
