#!/usr/bin/env bash
set -e

echo "🏗️ [TSD CNB] Build phase started"
echo "📦 Installing dependencies and configuring Node.js manually (placeholder)"

# Просто копіює все в /layers/tsd-layer і встановлює запуск
APP_DIR=${1}
LAYERS_DIR=${2}
ENV_DIR=${3}

mkdir -p "${LAYERS_DIR}/tsd-layer"
cp -r "${APP_DIR}"/* "${LAYERS_DIR}/tsd-layer/"

cat > "${LAYERS_DIR}/tsd-layer/launch.toml" <<EOF
[[processes]]
type = "web"
command = "node"
args = ["app.js"]
default = true
EOF

echo "✅ [TSD CNB] Build phase finished"
